

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Clairvoyance &mdash; Clairvoyance 0.1.dev0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Clairvoyance Tutorial" href="intro/tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Clairvoyance
          

          
          </a>

          
            
            
              <div class="version">
                0.1.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro/install.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro/tutorial.html">Clairvoyance Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Full API reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Clairvoyance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-prediction">Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-imputation">Imputation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-interpretation">Interpretation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-uncertainty">Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-evaluation">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-automl">AutoML</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-active_sensing">Active Sensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-feature_selection">Feature Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-treatments">Treatment Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-utils">Utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Clairvoyance</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Clairvoyance</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="clairvoyance">
<span id="api"></span><h1>Clairvoyance<a class="headerlink" href="#clairvoyance" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-datasets">
<span id="datasets"></span><h2>Datasets<a class="headerlink" href="#module-datasets" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="datasets.CSVLoader">
<em class="property">class </em><code class="sig-prename descclassname">datasets.</code><code class="sig-name descname">CSVLoader</code><span class="sig-paren">(</span><em class="sig-param">static_file=None</em>, <em class="sig-param">temporal_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasets/data_loader.html#CSVLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#datasets.CSVLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Load datasets from csv files.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- static_file</code></dt>
<dd><p>file name of static data</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- temporal_file</code></dt>
<dd><p>file name of temporal data</p>
</dd></dl>

<dl class="method">
<dt id="datasets.CSVLoader.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasets/data_loader.html#CSVLoader.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#datasets.CSVLoader.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Return both temporal and static datasets in PandasDataset format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="datasets.PandasDataset">
<em class="property">class </em><code class="sig-prename descclassname">datasets.</code><code class="sig-name descname">PandasDataset</code><span class="sig-paren">(</span><em class="sig-param">static_data</em>, <em class="sig-param">temporal_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/datasets/dataset.html#PandasDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#datasets.PandasDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one-hot encoded dataset.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- static_data</code></dt>
<dd><p>raw static data set.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- temporal_data</code></dt>
<dd><p>raw temporal data set.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-preprocessing">
<span id="preprocessing"></span><h2>Preprocessing<a class="headerlink" href="#module-preprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="preprocessing.FilterNegative">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">FilterNegative</code><a class="reference internal" href="_modules/preprocessing/outlier_filter.html#FilterNegative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.FilterNegative" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the negative values to NaN.</p>
<dl class="method">
<dt id="preprocessing.FilterNegative.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/outlier_filter.html#FilterNegative.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.FilterNegative.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the negative values to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset without negative values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.FilterOutOfRange">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">FilterOutOfRange</code><span class="sig-paren">(</span><em class="sig-param">range_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/outlier_filter.html#FilterOutOfRange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.FilterOutOfRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any values out of range to NAN.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- range_list</code></dt>
<dd><p>a list of dictionaries. Each dictionary has three keys ‘variable’, ‘high’ and ‘low’.
e.g. {‘variable’: ‘aao2’, ‘high’: 700., ‘low’:10.}</p>
</dd></dl>

<dl class="method">
<dt id="preprocessing.FilterOutOfRange.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/outlier_filter.html#FilterOutOfRange.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.FilterOutOfRange.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the values outside of the range to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset without outlier</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.OneHotEncoder">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">OneHotEncoder</code><span class="sig-paren">(</span><em class="sig-param">one_hot_encoding_features</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#OneHotEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.OneHotEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one-hot encoded dataset.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- one_hot_encoding_feature</code></dt>
<dd><p>features that need one-hot encoding.</p>
</dd></dl>

<dl class="method">
<dt id="preprocessing.OneHotEncoder.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#OneHotEncoder.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.OneHotEncoder.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform fit on df and returns a new X with invalid values filtered.
:param dataset: Input data.
:type dataset: a data set</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>new dataset</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Transformed data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="preprocessing.OneHotEncoder.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#OneHotEncoder.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.OneHotEncoder.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform original dataset to one-hot encoded data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>one-hot encoded PandasDataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.MinMaxNormalizer">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">MinMaxNormalizer</code><a class="reference internal" href="_modules/preprocessing/encoding.html#MinMaxNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.MinMaxNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the data to make the range within [0, 1].</p>
<dl class="method">
<dt id="preprocessing.MinMaxNormalizer.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#MinMaxNormalizer.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.MinMaxNormalizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform original dataset to MinMax normalized dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized PandasDataset
- norm_parameters: normalization parameters for renomalization</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="preprocessing.MinMaxNormalizer.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#MinMaxNormalizer.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.MinMaxNormalizer.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform original dataset to MinMax normalized dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized PandasDataset
- norm_parameters: normalization parameters for renomalization</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.StandardNormalizer">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">StandardNormalizer</code><a class="reference internal" href="_modules/preprocessing/encoding.html#StandardNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.StandardNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the data to make mean = 0 and std = 1.</p>
<dl class="method">
<dt id="preprocessing.StandardNormalizer.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#StandardNormalizer.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.StandardNormalizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform original dataset to standard normalized dataset.</p>
<p>Very similar to MinMaxNormalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized PandasDataset
- norm_parameters: normalization parameters for renomalization</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.ReNormalizer">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">ReNormalizer</code><span class="sig-paren">(</span><em class="sig-param">norm_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#ReNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.ReNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Recover the original data from normalized data.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- norm_parameters</code></dt>
<dd><p>normalization parameters for renomalization</p>
</dd></dl>

<dl class="method">
<dt id="preprocessing.ReNormalizer.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#ReNormalizer.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.ReNormalizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform normalized dataset to original dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – normalized PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>original PandasDataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.Normalizer">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">Normalizer</code><span class="sig-paren">(</span><em class="sig-param">normalizer_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#Normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.Normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the data.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- normalizer_name</code></dt>
<dd><p>‘minmax’ or ‘standard’</p>
</dd></dl>

<dl class="method">
<dt id="preprocessing.Normalizer.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#Normalizer.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.Normalizer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform original dataset to standard normalized dataset.</p>
<p>Very similar to MinMaxNormalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original PandasDataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized PandasDataset
- norm_parameters: normalization parameters for renomalization</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="preprocessing.ProblemMaker">
<em class="property">class </em><code class="sig-prename descclassname">preprocessing.</code><code class="sig-name descname">ProblemMaker</code><span class="sig-paren">(</span><em class="sig-param">problem</em>, <em class="sig-param">label</em>, <em class="sig-param">max_seq_len</em>, <em class="sig-param">treatment=None</em>, <em class="sig-param">window=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#ProblemMaker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.ProblemMaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Define temporal, static, time, label, and treatment features.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- problem</code></dt>
<dd><p>‘online’ or ‘one-shot’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- label</code></dt>
<dd><p>label names in list format</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- max_seq_len</code></dt>
<dd><p>maximum sequence length</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- treatment</code></dt>
<dd><p>the feature names for treatment features</p>
</dd></dl>

<dl class="method">
<dt id="preprocessing.ProblemMaker.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#ProblemMaker.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.ProblemMaker.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the dataset based on the Pandas Dataframe to numpy array.</p>
<p>Returned dataset has temporal, static, time, label and treatment features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>defined dataset for the certain problem</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="preprocessing.ProblemMaker.pad_sequence">
<code class="sig-name descname">pad_sequence</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/preprocessing/encoding.html#ProblemMaker.pad_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#preprocessing.ProblemMaker.pad_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns numpy array for predictor model training and testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>-</em>) – temporal data in DataFrame</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>preprocessed temporal data in 3d numpy array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>x_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-prediction">
<span id="prediction"></span><h2>Prediction<a class="headerlink" href="#module-prediction" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="prediction.GeneralRNN">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">GeneralRNN</code><span class="sig-paren">(</span><em class="sig-param">task=None</em>, <em class="sig-param">model_type=None</em>, <em class="sig-param">model_type_id=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='general_rnn_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>RNN predictive model to time-series.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_type</code></dt>
<dd><p>‘rnn’, ‘lstm’, or ‘gru’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for saving</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- verbose</code></dt>
<dd><p>print intermediate process</p>
</dd></dl>

<dl class="method">
<dt id="prediction.GeneralRNN.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the predictor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained predictor model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.predictor_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.GeneralRNN.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.GeneralRNN.new">
<code class="sig-name descname">new</code><span class="sig-paren">(</span><em class="sig-param">model_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN.new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new model with the same parameter as the existing one.
:param - model_id: an unique identifier for the new model</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>a new GeneralRNN</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.GeneralRNN.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the temporal and feature importance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on testing set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.GeneralRNN.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/general_rnn.html#GeneralRNN.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.GeneralRNN.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.AutoEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">AutoEnsemble</code><span class="sig-paren">(</span><em class="sig-param">models</em>, <em class="sig-param">bo_score</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/bo_ensemble.html#AutoEnsemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.AutoEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Making a model ensemble based on AutoML results.</p>
<p class="rubric">References</p>
<p>Y. Zhang, D. Jarrett, M. van der Schaar, “Stepwise Model Selection for Sequence Prediction
via Deep Kernel Learning,” International Conference on Artificial Intelligence and Statistics (AISTATS), 2020.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This model can only be created using the results of AutoML. It therefore does not have a <cite>fit</cite> method.</p>
</div>
<dl class="method">
<dt id="prediction.AutoEnsemble.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/bo_ensemble.html#AutoEnsemble.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.AutoEnsemble.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Making prediction with the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The input <a class="reference internal" href="#datasets.PandasDataset" title="datasets.PandasDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">PandasDataset</span></code></a> object with problem defined consistently with the model.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments to be passed to the predict method of the base models in the ensemble.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Predictions.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.TransferLearning">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">TransferLearning</code><span class="sig-paren">(</span><em class="sig-param">predictor_class</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transfer_learning.html#TransferLearning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransferLearning" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer learning model for time-series.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- predictor_class</code></dt>
<dd><p>trained pre-trained predictive model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_parameters</code></dt>
<dd><ul class="simple">
<li><p>model_type: ‘rnn’, ‘lstm’, or ‘gru’</p></li>
<li><p>h_dim: hidden dimensions</p></li>
<li><p>n_layer: the number of layers</p></li>
<li><p>batch_size: the number of samples in each batch</p></li>
<li><p>epoch: the number of iteration epochs</p></li>
<li><p>learning_rate: the number of iteration epochs</p></li>
<li><p>verbose: print the intermediate results</p></li>
</ul>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="method">
<dt id="prediction.TransferLearning.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transfer_learning.html#TransferLearning.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransferLearning.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the transfer learning model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained transfer model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.transfer_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TransferLearning.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transfer_learning.html#TransferLearning.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransferLearning.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TransferLearning.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transfer_learning.html#TransferLearning.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransferLearning.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the predictions from the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TransferLearning.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transfer_learning.html#TransferLearning.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransferLearning.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.Attention">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">Attention</code><span class="sig-paren">(</span><em class="sig-param">task=None</em>, <em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='attention_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention" title="Permalink to this definition">¶</a></dt>
<dd><p>Attention model on top of RNN for time-series prediction.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_type</code></dt>
<dd><p>‘rnn’, ‘lstm’, or ‘gru’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for saving</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- verbose</code></dt>
<dd><p>print intermediate process</p>
</dd></dl>

<dl class="method">
<dt id="prediction.Attention.attention_3d_block">
<code class="sig-name descname">attention_3d_block</code><span class="sig-paren">(</span><em class="sig-param">hidden_states</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention.attention_3d_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention.attention_3d_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Attention mechanism.</p>
<p>Ref: <a class="reference external" href="https://github.com/philipperemy/keras-attention-mechanism">https://github.com/philipperemy/keras-attention-mechanism</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hidden_states</strong> (<em>-</em>) – RNN hidden states (3d array)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>output states after attention mechanism.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>attention_vector</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.Attention.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the attention model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained attention model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.attention_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.Attention.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.Attention.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict on the new dataset by the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on the new dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.Attention.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/attention.html#Attention.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.Attention.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.TemporalCNN">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">TemporalCNN</code><span class="sig-paren">(</span><em class="sig-param">task=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='tcn_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/temporal_cnn.html#TemporalCNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TemporalCNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporal CNN model for for time-series prediction.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for saving</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- verbose</code></dt>
<dd><p>print intermediate process</p>
</dd></dl>

<dl class="method">
<dt id="prediction.TemporalCNN.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/temporal_cnn.html#TemporalCNN.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TemporalCNN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the temporal CNN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained temporal CNN model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.tcn_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TemporalCNN.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/temporal_cnn.html#TemporalCNN.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TemporalCNN.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TemporalCNN.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/temporal_cnn.html#TemporalCNN.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TemporalCNN.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict on the new dataset by the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on the new dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TemporalCNN.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/temporal_cnn.html#TemporalCNN.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TemporalCNN.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.TransformerPredictor">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">TransformerPredictor</code><span class="sig-paren">(</span><em class="sig-param">task=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">n_head=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='transformer_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">device=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transformer.html#TransformerPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransformerPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformer model for for time-series prediction.</p>
<p>Ref: Vaswani, Ashish, et al. “Attention is all you need.” Advances in neural information processing systems. 2017.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_head</code></dt>
<dd><p>number of attention heads</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- learning_rate</code></dt>
<dd><p>the learning rate for the optimizer</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for checkpointing</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- verbose</code></dt>
<dd><p>print intermediate process</p>
</dd></dl>

<dl class="method">
<dt id="prediction.TransformerPredictor.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transformer.html#TransformerPredictor.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransformerPredictor.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the predictor model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained predictor model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.predictor_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TransformerPredictor.new">
<code class="sig-name descname">new</code><span class="sig-paren">(</span><em class="sig-param">model_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transformer.html#TransformerPredictor.new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransformerPredictor.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new model with the same parameter as the existing one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_id</strong> (<em>-</em>) – an unique identifier for the new model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>a new GeneralRNN</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.TransformerPredictor.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/transformer.html#TransformerPredictor.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.TransformerPredictor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict on the new dataset by the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on the new dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prediction.StackingEnsemble">
<em class="property">class </em><code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">StackingEnsemble</code><span class="sig-paren">(</span><em class="sig-param">model_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/stacking_ensemble.html#StackingEnsemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.StackingEnsemble" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="prediction.StackingEnsemble.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/stacking_ensemble.html#StackingEnsemble.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.StackingEnsemble.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform fit on df
:param dataset: Input data.
:type dataset: a data set</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="prediction.StackingEnsemble.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/stacking_ensemble.html#StackingEnsemble.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.StackingEnsemble.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform predict on df
:param dataset: Input data.
:type dataset: a data set</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="prediction.prediction">
<code class="sig-prename descclassname">prediction.</code><code class="sig-name descname">prediction</code><span class="sig-paren">(</span><em class="sig-param">model_name</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prediction/prediction.html#prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prediction.prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine predictive model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>-</em>) – ‘attention’, ‘rnn’, ‘lstm’, ‘gru’, ‘tcn’, ‘transformer’</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters of the models</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictive model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>pred_class</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-imputation">
<span id="imputation"></span><h2>Imputation<a class="headerlink" href="#module-imputation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="imputation.BasicImputation">
<em class="property">class </em><code class="sig-prename descclassname">imputation.</code><code class="sig-name descname">BasicImputation</code><span class="sig-paren">(</span><em class="sig-param">imputation_model_name</em>, <em class="sig-param">data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#BasicImputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.BasicImputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean and median imputation.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- imputation_model_name</code></dt>
<dd><p>‘mean’ or ‘median’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- data_type</code></dt>
<dd><p>‘temporal’ or ‘static’</p>
</dd></dl>

<dl class="method">
<dt id="imputation.BasicImputation.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#BasicImputation.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.BasicImputation.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mean or median values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.BasicImputation.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#BasicImputation.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.BasicImputation.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.BasicImputation.positive_mean_median_computation">
<code class="sig-name descname">positive_mean_median_computation</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#BasicImputation.positive_mean_median_computation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.BasicImputation.positive_mean_median_computation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mean or median without nan and padded values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>-</em>) – incomplete data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean or median of each variable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>vals</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.BasicImputation.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#BasicImputation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.BasicImputation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return mean or median imputed dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean or median imputed dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="imputation.Interpolation">
<em class="property">class </em><code class="sig-prename descclassname">imputation.</code><code class="sig-name descname">Interpolation</code><span class="sig-paren">(</span><em class="sig-param">interpolation_model_name</em>, <em class="sig-param">data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Interpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporal data interpolation.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- interpolation_model_name</code></dt>
<dd><p>‘linear’, ‘quadratic’, ‘cubic’, ‘spline’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- data_type</code></dt>
<dd><p>‘temporal’</p>
</dd></dl>

<dl class="method">
<dt id="imputation.Interpolation.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Interpolation.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Interpolation.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute median values for median imputation.</p>
<p>Interpolation does not need fitting (before). But median imputation needs fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.Interpolation.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Interpolation.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Interpolation.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.Interpolation.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Interpolation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Interpolation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return interpolated dataset &amp; median imputed dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>interpolated dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="imputation.NNImputation">
<em class="property">class </em><code class="sig-prename descclassname">imputation.</code><code class="sig-name descname">NNImputation</code><span class="sig-paren">(</span><em class="sig-param">imputation_model_name</em>, <em class="sig-param">data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#NNImputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.NNImputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural network based imputation method.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- imputation_model_name</code></dt>
<dd><p>‘tgain’ or ‘mrnn’ for temporal data, ‘gain’ for static data</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- data_type</code></dt>
<dd><p>‘static’ or ‘temporal’</p>
</dd></dl>

<dl class="method">
<dt id="imputation.NNImputation.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#NNImputation.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.NNImputation.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train NN based imputation modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.NNImputation.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#NNImputation.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.NNImputation.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.NNImputation.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#NNImputation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.NNImputation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return imputed data using NN imputation modules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imputed dataset after NN based imputation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="imputation.StandardImputation">
<em class="property">class </em><code class="sig-prename descclassname">imputation.</code><code class="sig-name descname">StandardImputation</code><span class="sig-paren">(</span><em class="sig-param">imputation_model_name</em>, <em class="sig-param">data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#StandardImputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.StandardImputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard imputation method for static data.</p>
<p>Reference 1: <a class="reference external" href="https://pypi.org/project/missingpy/">https://pypi.org/project/missingpy/</a>
Reference 2: <a class="reference external" href="https://s3.amazonaws.com/assets.datacamp.com/production/course_17404/slides/chapter4.pdf">https://s3.amazonaws.com/assets.datacamp.com/production/course_17404/slides/chapter4.pdf</a></p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- imputation_model_name</code></dt>
<dd><p>‘mice’, ‘missforest’, ‘knn’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- data_type</code></dt>
<dd><p>‘static’</p>
</dd></dl>

<dl class="method">
<dt id="imputation.StandardImputation.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#StandardImputation.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.StandardImputation.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train standard imputation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.StandardImputation.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#StandardImputation.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.StandardImputation.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.StandardImputation.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#StandardImputation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.StandardImputation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return imputed dataset by standard imputation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imputed dataset by standard imputation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="imputation.Imputation">
<em class="property">class </em><code class="sig-prename descclassname">imputation.</code><code class="sig-name descname">Imputation</code><span class="sig-paren">(</span><em class="sig-param">imputation_model_name</em>, <em class="sig-param">data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Imputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Imputation" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean and median imputation.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- imputation_model_name</code></dt>
<dd><p>‘mean’ or ‘median’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- data_type</code></dt>
<dd><p>‘temporal’ or ‘static’</p>
</dd></dl>

<dl class="method">
<dt id="imputation.Imputation.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Imputation.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Imputation.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Train imputation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.Imputation.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Imputation.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Imputation.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="imputation.Imputation.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/imputation/imputation.html#Imputation.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#imputation.Imputation.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Return imputed dataset by standard imputation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>imputed dataset by standard imputation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-interpretation">
<span id="interpretation"></span><h2>Interpretation<a class="headerlink" href="#module-interpretation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="interpretation.TInvase">
<em class="property">class </em><code class="sig-prename descclassname">interpretation.</code><code class="sig-name descname">TInvase</code><span class="sig-paren">(</span><em class="sig-param">predictor_model=None</em>, <em class="sig-param">task=None</em>, <em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='interpretable_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase" title="Permalink to this definition">¶</a></dt>
<dd><p>INVASE extension to time-series.</p>
<p>Returns the temporal and feature importance for each patient.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- predictor_model</code></dt>
<dd><p>predictor_model for interpretation.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_type</code></dt>
<dd><p>‘rnn’, ‘lstm’, or ‘gru’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for saving</p>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.data_preprocess">
<code class="sig-name descname">data_preprocess</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold</em>, <em class="sig-param">split</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.data_preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.data_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess the dataset.</p>
<p>Returns feature and label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>split</strong> (<em>-</em>) – ‘train’, ‘valid’ or ‘test’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>temporal feature
- y_hat: predictions of the predictor model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>x</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the interpretation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained interpretor model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.interpretor_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the temporal and feature importance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>temporal and feature importance in 3d array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_s_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="interpretation.TInvase.set_params">
<code class="sig-name descname">set_params</code><span class="sig-paren">(</span><em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='interpretable_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/tinvase.html#TInvase.set_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.TInvase.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.
The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.
:param **params: Estimator parameters.
:type **params: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="interpretation.interpretation">
<code class="sig-prename descclassname">interpretation.</code><code class="sig-name descname">interpretation</code><span class="sig-paren">(</span><em class="sig-param">interpretor_model_name</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">pred_class</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/interpretation/interpretation.html#interpretation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#interpretation.interpretation" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine interpretation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interpretor_model_name</strong> (<em>-</em>) – ‘tinvase’</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters of the interpretor models</p></li>
<li><p><strong>pred_class</strong> (<em>-</em>) – predictor</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>determined interpretation model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>interpretor</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-uncertainty">
<span id="uncertainty"></span><h2>Uncertainty<a class="headerlink" href="#module-uncertainty" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="uncertainty.EnsembleUncertainty">
<em class="property">class </em><code class="sig-prename descclassname">uncertainty.</code><code class="sig-name descname">EnsembleUncertainty</code><span class="sig-paren">(</span><em class="sig-param">predictor_model=None</em>, <em class="sig-param">ensemble_model_type=None</em>, <em class="sig-param">task=None</em>, <em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Uncertainty estimator by ensemble method.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- predictor_model</code></dt>
<dd><p>original predictor model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- ensemble_model_type</code></dt>
<dd><p>types of models for ensemble model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_type</code></dt>
<dd><p>‘rnn’, ‘lstm’, or ‘gru’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="method">
<dt id="uncertainty.EnsembleUncertainty.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the ensemble models for uncertainty estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trained ensemble model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>self.ensemble_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="uncertainty.EnsembleUncertainty.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="uncertainty.EnsembleUncertainty.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the temporal and feature importance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>uncertainty of each predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_ci_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="uncertainty.EnsembleUncertainty.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – directory of the saved model (it should be /)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="uncertainty.EnsembleUncertainty.set_params">
<code class="sig-name descname">set_params</code><span class="sig-paren">(</span><em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/ensemble.html#EnsembleUncertainty.set_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.EnsembleUncertainty.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.
The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.
:param **params: Estimator parameters.
:type **params: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="uncertainty.uncertainty">
<code class="sig-prename descclassname">uncertainty.</code><code class="sig-name descname">uncertainty</code><span class="sig-paren">(</span><em class="sig-param">uncertainty_model_name</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">pred_class</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/uncertainty/uncertainty.html#uncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#uncertainty.uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine uncertainty model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uncertainty_model_name</strong> (<em>-</em>) – ‘ensemble’</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters of the interpretor models</p></li>
<li><p><strong>pred_class</strong> (<em>-</em>) – predictor</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>determined uncertainty estimation model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>uncertainty_model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-evaluation">
<span id="evaluation"></span><h2>Evaluation<a class="headerlink" href="#module-evaluation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="evaluation.Metrics">
<em class="property">class </em><code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">Metrics</code><span class="sig-paren">(</span><em class="sig-param">metric_sets</em>, <em class="sig-param">metric_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/metrics.html#Metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.Metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Metric class in general.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- metric_sets</code></dt>
<dd><p>performance metric sets (e.g. [‘auc’,’apr’])</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- metric_parameters</code></dt>
<dd><p>problem definition and label names</p>
</dd></dl>

<dl class="method">
<dt id="evaluation.Metrics.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">test_y</em>, <em class="sig-param">test_y_hat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/metrics.html#Metrics.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.Metrics.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prediction performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_y</strong> (<em>-</em>) – testing labels</p></li>
<li><p><strong>test_y_hat</strong> (<em>-</em>) – predictions on testing set</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>performance on testing set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>result</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="evaluation.Metrics.metric_each">
<code class="sig-name descname">metric_each</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">y_hat</em>, <em class="sig-param">metric_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/metrics.html#Metrics.metric_each"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.Metrics.metric_each" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute metrics for each metric name (AUC, APR, MSE, MAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – labels</p></li>
<li><p><strong>y_hat</strong> – predictions</p></li>
<li><p><strong>metric_name</strong> – type of metrics</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>computed performance metric.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>result</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="evaluation.BOMetric">
<em class="property">class </em><code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">BOMetric</code><span class="sig-paren">(</span><em class="sig-param">metric</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/metrics.html#BOMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.BOMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Metric class used for AutoML.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- metric</code></dt>
<dd><p>metric_sets: performance metric sets (e.g. [‘auc’,’apr’])</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- fold</code></dt>
<dd><p>The fold in the data set to evaluate model.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- split</code></dt>
<dd><p>The split in the data set to evaluate model.</p>
</dd></dl>

<dl class="method">
<dt id="evaluation.BOMetric.eval">
<code class="sig-name descname">eval</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">y_hat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/metrics.html#BOMetric.eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.BOMetric.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate model prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – A <a class="reference internal" href="#datasets.PandasDataset" title="datasets.PandasDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">PandasDataset</span></code></a> with problem defined.</p></li>
<li><p><strong>y_hat</strong> (<em>-</em>) – The predicted values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>The evaluation metric at each time step as a numpy 2D array with shape <cite>[1, n_time_step]</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The accuracy metrics (e.g. auc) will be multiplied by <cite>-1</cite> and presented as a “loss”.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="evaluation.print_performance">
<code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">print_performance</code><span class="sig-paren">(</span><em class="sig-param">performance</em>, <em class="sig-param">metric_sets</em>, <em class="sig-param">metric_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/output_visualization.html#print_performance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.print_performance" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the overall performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>performance</strong> (<em>-</em>) – dictionary based performances</p></li>
<li><p><strong>metric_sets</strong> (<em>-</em>) – sets of metric</p></li>
<li><p><strong>metric_parameters</strong> (<em>-</em>) – parameters for the problem and labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>For online prediction, returns graphs</p></li>
<li><p>For one-shot prediction, returns table</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="evaluation.print_prediction">
<code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">print_prediction</code><span class="sig-paren">(</span><em class="sig-param">predictions</em>, <em class="sig-param">metric_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/output_visualization.html#print_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.print_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>-</em>) – predictions of each patient</p></li>
<li><p><strong>metric_parameters</strong> (<em>-</em>) – parameters for the problem and labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>For online predictions, returns graphs</p></li>
<li><p>For one-shot predictions, returns table</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="evaluation.print_uncertainty">
<code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">print_uncertainty</code><span class="sig-paren">(</span><em class="sig-param">predictions</em>, <em class="sig-param">uncertainties</em>, <em class="sig-param">metric_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/output_visualization.html#print_uncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.print_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the predictions with uncertainties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>-</em>) – predictions of each patient</p></li>
<li><p><strong>uncertainties</strong> (<em>-</em>) – uncertainties of each prediction</p></li>
<li><p><strong>metric_parameters</strong> (<em>-</em>) – parameters for the problem and labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>For online predictions, returns graphs</p></li>
<li><p>For one-shot predictions, returns table</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="evaluation.print_interpretation">
<code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">print_interpretation</code><span class="sig-paren">(</span><em class="sig-param">interpretations</em>, <em class="sig-param">feature_name</em>, <em class="sig-param">metric_parameters</em>, <em class="sig-param">model_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/output_visualization.html#print_interpretation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.print_interpretation" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the interpretation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interpretations</strong> (<em>-</em>) – interpretations of each patient</p></li>
<li><p><strong>temporal features</strong> (<em>-</em>) – y-axis of the heatmap</p></li>
<li><p><strong>metric_parameters</strong> (<em>-</em>) – parameters for the problem and labels</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters for the predictor model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Feature and temporal importance for each patient on heatmap</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="evaluation.print_counterfactual_predictions">
<code class="sig-prename descclassname">evaluation.</code><code class="sig-name descname">print_counterfactual_predictions</code><span class="sig-paren">(</span><em class="sig-param">patient_history</em>, <em class="sig-param">treatment_options</em>, <em class="sig-param">counterfactual_predictions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/evaluation/output_visualization.html#print_counterfactual_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evaluation.print_counterfactual_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the counterfactual predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patient_history</strong> (<em>-</em>) – </p></li>
<li><p><strong>treatment_options</strong> (<em>-</em>) – </p></li>
<li><p><strong>counterfactual_predictions</strong> (<em>-</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Counterfactual predictions in graph</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-automl">
<span id="automl"></span><h2>AutoML<a class="headerlink" href="#module-automl" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="automl.AutoTS">
<em class="property">class </em><code class="sig-prename descclassname">automl.</code><code class="sig-name descname">AutoTS</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">model</em>, <em class="sig-param">metric</em>, <em class="sig-param">rnn_hidden_size=64</em>, <em class="sig-param">h_size=32</em>, <em class="sig-param">num_h=32</em>, <em class="sig-param">rho_size=2</em>, <em class="sig-param">lr=0.01</em>, <em class="sig-param">model_path='tmp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/automl/model.html#AutoTS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#automl.AutoTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Automated hyperparameter tuning for time series prediction.</p>
<p class="rubric">References</p>
<p>Y. Zhang, D. Jarrett, M. van der Schaar, “Stepwise Model Selection for Sequence Prediction
via Deep Kernel Learning,” International Conference on Artificial Intelligence and Statistics (AISTATS), 2020.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – A <a class="reference internal" href="#datasets.PandasDataset" title="datasets.PandasDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">PandasDataset</span></code></a> object with <em>train and validation split defined</em>.</p></li>
<li><p><strong>model</strong> – A predictor, for example, <a class="reference internal" href="#prediction.GeneralRNN" title="prediction.GeneralRNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralRNN</span></code></a>.</p></li>
<li><p><strong>metric</strong> – A <a class="reference internal" href="#evaluation.BOMetric" title="evaluation.BOMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">BOMetric</span></code></a> object, which measures model performance.</p></li>
<li><p><strong>rnn_hidden_size</strong> – (Advanced) RNN hidden size of the AutoML model.</p></li>
<li><p><strong>h_size</strong> – (Advanced) Hidden size of the AutoML model.</p></li>
<li><p><strong>num_h</strong> – (Advanced) Number of Hidden of the AutoML model.</p></li>
<li><p><strong>rho_size</strong> – (Advanced) Rho size of the AutoML model.</p></li>
<li><p><strong>lr</strong> – (Advanced) Learning rate of the AutoML model.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters marked ‘Advanced’ is for developers only.
End users are recommended to accepted the default.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- All</code></dt>
<dd><p>All attributes of this class are private.</p>
</dd></dl>

<dl class="method">
<dt id="automl.AutoTS.training_loop">
<code class="sig-name descname">training_loop</code><span class="sig-paren">(</span><em class="sig-param">num_iter=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/automl/model.html#AutoTS.training_loop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#automl.AutoTS.training_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Run AutoML algorithm with initialized values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_iter</strong> – Number of Bayesian Optimization iterations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>List of models trained with different hyperparameters during the optimization.</p></li>
<li><p>The performance of the models. Use this value to create a model ensemble with <a class="reference internal" href="#prediction.AutoEnsemble" title="prediction.AutoEnsemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoEnsemble</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-active_sensing">
<span id="active-sensing"></span><h2>Active Sensing<a class="headerlink" href="#module-active_sensing" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="active_sensing.Asac">
<em class="property">class </em><code class="sig-prename descclassname">active_sensing.</code><code class="sig-name descname">Asac</code><span class="sig-paren">(</span><em class="sig-param">task=None</em>, <em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='asac_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac" title="Permalink to this definition">¶</a></dt>
<dd><p>Asac core functions.</p>
<p>Returns the next time measurement.</p>
<p class="rubric">References</p>
<ol class="upperalpha simple" start="10">
<li><p>Yoon, J. Jordon, M. van der Schaar, “ASAC: Active Sensing using Actor-Critic models,” MLHC, 2019</p></li>
</ol>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_type</code></dt>
<dd><p>‘rnn’, ‘lstm’, or ‘gru’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- h_dim</code></dt>
<dd><p>hidden dimensions</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- n_layer</code></dt>
<dd><p>the number of layers</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- batch_size</code></dt>
<dd><p>the number of samples in each batch</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- epoch</code></dt>
<dd><p>the number of iteration epochs</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- static_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- time_mode</code></dt>
<dd><p>‘concatenate’ or None</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_id</code></dt>
<dd><p>the name of model</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_path</code></dt>
<dd><p>model path for saving</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- verbose</code></dt>
<dd></dd></dl>

<dl class="method">
<dt id="active_sensing.Asac.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">valid_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the interpretation model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.Asac.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.Asac.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the temporal and feature importance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>next measurements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_s_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.Asac.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.Asac.set_params">
<code class="sig-name descname">set_params</code><span class="sig-paren">(</span><em class="sig-param">model_type=None</em>, <em class="sig-param">h_dim=None</em>, <em class="sig-param">n_layer=None</em>, <em class="sig-param">batch_size=None</em>, <em class="sig-param">epoch=None</em>, <em class="sig-param">learning_rate=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em>, <em class="sig-param">model_id='asac_model'</em>, <em class="sig-param">model_path='tmp'</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/asac.html#Asac.set_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.Asac.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.
The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.
:param **params: Estimator parameters.
:type **params: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="active_sensing.DeepSensing">
<em class="property">class </em><code class="sig-prename descclassname">active_sensing.</code><code class="sig-name descname">DeepSensing</code><span class="sig-paren">(</span><em class="sig-param">model_parameters</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep Sensing class.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- model_parameters</code></dt>
<dd><p>predictive model parameters (including h_dim, etc.)</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep sensing model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – training dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load and return the model from model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.model_train">
<code class="sig-name descname">model_train</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.model_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.model_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train predictive model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – training dataset</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters for training model</p></li>
<li><p><strong>task</strong> (<em>-</em>) – classification or regression</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>class of predictive model
- pred_model: trained predictive model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>pred_class</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.new_label_generation">
<code class="sig-name descname">new_label_generation</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">split='all'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.new_label_generation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.new_label_generation" title="Permalink to this definition">¶</a></dt>
<dd><p>Label generation for deep sensing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – training dataset</p></li>
<li><p><strong>split</strong> (<em>-</em>) – use the entire data (‘all’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new labels for training deep sensing model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>y_tilde</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">threshold=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the active sensing results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – testing dataset</p></li>
<li><p><strong>threshold</strong> (<em>-</em>) – selection threshold</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>selection results by deep sensing</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>selection</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="active_sensing.DeepSensing.save_model">
<code class="sig-name descname">save_model</code><span class="sig-paren">(</span><em class="sig-param">model_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/deepsensing.html#DeepSensing.save_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.DeepSensing.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to model_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_path</strong> (<em>-</em>) – path of the saved model (it should be .h5)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="active_sensing.active_sensing">
<code class="sig-prename descclassname">active_sensing.</code><code class="sig-name descname">active_sensing</code><span class="sig-paren">(</span><em class="sig-param">active_sensing_model_name</em>, <em class="sig-param">model_parameters</em>, <em class="sig-param">task</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/active_sensing/active_sensing.html#active_sensing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#active_sensing.active_sensing" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine active sensing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>-</em>) – ‘asac’, ‘deepsensing’</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters of the models</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>active sensing model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>active_sensing_class</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-feature_selection">
<span id="feature-selection"></span><h2>Feature Selection<a class="headerlink" href="#module-feature_selection" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="feature_selection.FeatureSelection">
<em class="property">class </em><code class="sig-prename descclassname">feature_selection.</code><code class="sig-name descname">FeatureSelection</code><span class="sig-paren">(</span><em class="sig-param">feature_selection_model_name</em>, <em class="sig-param">feature_type</em>, <em class="sig-param">feature_number</em>, <em class="sig-param">task</em>, <em class="sig-param">metric_name</em>, <em class="sig-param">metric_parameters</em>, <em class="sig-param">model_parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection" title="Permalink to this definition">¶</a></dt>
<dd><p>Feature selection module.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- task</code></dt>
<dd><p>classification or regression</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- metric_name</code></dt>
<dd><p>‘auc’, ‘apr’, ‘mae’, ‘mse’</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- metric_parameters</code></dt>
<dd><p>problem setting and labels</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">- model_parameters</code></dt>
<dd><p>parameters for training model</p>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit feature selection module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original input data</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and transform. Return imputed data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – incomplete dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.greedy_feature_selection">
<code class="sig-name descname">greedy_feature_selection</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">feature_selection_model</em>, <em class="sig-param">feature_type</em>, <em class="sig-param">feature_number</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.greedy_feature_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.greedy_feature_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Select subset of the features in greedy way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – dataset with subset of temporal features</p></li>
<li><p><strong>feature_selection_model</strong> (<em>-</em>) – ‘addition’ or ‘deletion’</p></li>
<li><p><strong>feature_type</strong> (<em>-</em>) – ‘static’ or ‘temporal’</p></li>
<li><p><strong>feature_number</strong> (<em>-</em>) – the number of selected features</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>selected feature index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>selected_feature_index</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.model_predict_and_evaluate">
<code class="sig-name descname">model_predict_and_evaluate</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.model_predict_and_evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.model_predict_and_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Train model with subset of the features and evalaute the performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – dataset with subset of temporal features</p></li>
<li><p><strong>model_parameters</strong> (<em>-</em>) – parameters for training model</p></li>
<li><p><strong>task</strong> (<em>-</em>) – classification or regression</p></li>
<li><p><strong>metric_name</strong> (<em>-</em>) – ‘auc’, ‘apr’, ‘mae’, ‘mse’</p></li>
<li><p><strong>metric_parameters</strong> (<em>-</em>) – problem setting and labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>performance with subset of temporal features</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>performance</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.recursive_feature_selection">
<code class="sig-name descname">recursive_feature_selection</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">feature_selection_model</em>, <em class="sig-param">feature_type</em>, <em class="sig-param">feature_number</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.recursive_feature_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.recursive_feature_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Select subset of the features in recursive way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – dataset with subset of temporal features</p></li>
<li><p><strong>feature_selection_model</strong> (<em>-</em>) – ‘addition’ or ‘deletion’</p></li>
<li><p><strong>feature_type</strong> (<em>-</em>) – ‘static’ or ‘temporal’</p></li>
<li><p><strong>feature_number</strong> (<em>-</em>) – the number of selected features</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>selected feature index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>curr_set</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="feature_selection.FeatureSelection.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/feature_selection/feature_selection.html#FeatureSelection.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#feature_selection.FeatureSelection.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Remain only selected features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – original input data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset only with selected features</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-treatments">
<span id="treatment-effect"></span><h2>Treatment Effect<a class="headerlink" href="#module-treatments" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="treatments.CRN_Model">
<em class="property">class </em><code class="sig-prename descclassname">treatments.</code><code class="sig-name descname">CRN_Model</code><span class="sig-paren">(</span><em class="sig-param">hyperparams</em>, <em class="sig-param">b_train_decoder=False</em>, <em class="sig-param">task=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the Counterfactual Recurrent Network (CRN).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyperparams</strong> (<em>-</em>) – dictionary with the hyperparameters specifying the architecture of the CRN model.</p></li>
<li><p><strong>b_train_decoder</strong> (<em>-</em>) – boolean value indicating whether to train decoder model.</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’</p></li>
<li><p><strong>static_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
<li><p><strong>time_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="treatments.CRN_Model.build_balancing_representation">
<code class="sig-name descname">build_balancing_representation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.build_balancing_representation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.build_balancing_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>Process input using RNN with LSTM cell to build the balancing representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>balancing representation for each timestep in the sequence.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>balancing_representation</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.build_feed_dictionary">
<code class="sig-name descname">build_feed_dictionary</code><span class="sig-paren">(</span><em class="sig-param">batch_current_covariates</em>, <em class="sig-param">batch_previous_treatments</em>, <em class="sig-param">batch_current_treatments</em>, <em class="sig-param">batch_init_state</em>, <em class="sig-param">batch_active_entries</em>, <em class="sig-param">batch_outputs=None</em>, <em class="sig-param">alpha_current=1.0</em>, <em class="sig-param">training_mode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.build_feed_dictionary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.build_feed_dictionary" title="Permalink to this definition">¶</a></dt>
<dd><p>Build feed dictionary for TensorFlow graph.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.build_outcomes">
<code class="sig-name descname">build_outcomes</code><span class="sig-paren">(</span><em class="sig-param">balancing_representation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.build_outcomes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.build_outcomes" title="Permalink to this definition">¶</a></dt>
<dd><p>Outcome predictor. Estimates potential outcomes given balancing representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>balancing_representation</strong> (<em>-</em>) – balancing representation for each timestep in the sequence.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted factual outcome.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>outcome_predictions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.build_treatment_assignments_one_hot">
<code class="sig-name descname">build_treatment_assignments_one_hot</code><span class="sig-paren">(</span><em class="sig-param">balancing_representation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.build_treatment_assignments_one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.build_treatment_assignments_one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p>Treatment classifier. Predicts treatment from the built representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>balancing_representation</strong> (<em>-</em>) – balancing representation for each timestep in the sequence.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>softmax output with probabilities for each treatment given the representation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>treatment_prob_predictions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.compute_loss_predictions">
<code class="sig-name descname">compute_loss_predictions</code><span class="sig-paren">(</span><em class="sig-param">outputs</em>, <em class="sig-param">predictions</em>, <em class="sig-param">active_entries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.compute_loss_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.compute_loss_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes mean squared error loss for outcome prediction.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.compute_loss_treatments_one_hot">
<code class="sig-name descname">compute_loss_treatments_one_hot</code><span class="sig-paren">(</span><em class="sig-param">target_treatments</em>, <em class="sig-param">treatment_predictions</em>, <em class="sig-param">active_entries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.compute_loss_treatments_one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.compute_loss_treatments_one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cross-entropy loss for treatment prediction.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.compute_validation_loss">
<code class="sig-name descname">compute_validation_loss</code><span class="sig-paren">(</span><em class="sig-param">validation_dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.compute_validation_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.compute_validation_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes validation losses for the validation dataset.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.fit_decoder">
<code class="sig-name descname">fit_decoder</code><span class="sig-paren">(</span><em class="sig-param">encoder_model</em>, <em class="sig-param">projection_horizon</em>, <em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">val_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.fit_decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.fit_decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the treatment effects encoder model model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder_model</strong> (<em>-</em>) – trained encoder model needed for initializing the decoder</p></li>
<li><p><strong>projection_horizon</strong> (<em>-</em>) – number of future timesteps for training decoder</p></li>
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.fit_encoder">
<code class="sig-name descname">fit_encoder</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">val_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.fit_encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.fit_encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the treatment effects encoder model model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.gen_epoch">
<code class="sig-name descname">gen_epoch</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">batch_size</em>, <em class="sig-param">training_mode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.gen_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.gen_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates epoch from training, by splitting the dataset into chunks of batch size.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.get_autoregressive_sequence_predictions">
<code class="sig-name descname">get_autoregressive_sequence_predictions</code><span class="sig-paren">(</span><em class="sig-param">test_data</em>, <em class="sig-param">b_with_uncertanty=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.get_autoregressive_sequence_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.get_autoregressive_sequence_predictions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Estimate patient outcomes under a sequence of future treatments given their past history of treatment and</dt><dd><p>covariates. Can only be used for the decoder model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_data</strong> (<em>-</em>) – dataset dictionary consisting of sequences of future treatments for which outcomes are estimated.</p></li>
<li><p><strong>projection_horizon</strong> (<em>-</em>) – number of timesteps in the future for estimating the patient outcomes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>counterfactual outcomes for a sequence of future treatments.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>predicted_outputs</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.get_balancing_reps">
<code class="sig-name descname">get_balancing_reps</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.get_balancing_reps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.get_balancing_reps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute balancing representations for patients in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – dataset with test patients</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>balancing representations at each timestep for patients in the dataset.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.get_predictions">
<code class="sig-name descname">get_predictions</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">b_with_uncertainty=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.get_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.get_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate one-step-ahead patient outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – dataset with test patients.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted one-step-ahead outcomes for patients in the dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>predictions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.init_model">
<code class="sig-name descname">init_model</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.init_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.init_model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>-</em>) – initialize the placeholder variables in the TensorFlow graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.load_crn_model">
<code class="sig-name descname">load_crn_model</code><span class="sig-paren">(</span><em class="sig-param">model_name</em>, <em class="sig-param">model_folder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.load_crn_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.load_crn_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load trained CRN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>-</em>) – name of saved model.</p></li>
<li><p><strong>model_folder</strong> (<em>-</em>) – directory with saved model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.load_network">
<code class="sig-name descname">load_network</code><span class="sig-paren">(</span><em class="sig-param">tf_session</em>, <em class="sig-param">model_dir</em>, <em class="sig-param">checkpoint_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.load_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.load_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Load trained network into a TensorFlow session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf_session</strong> (<em>-</em>) – TensorFlow session.</p></li>
<li><p><strong>model_dir</strong> (<em>-</em>) – directory with saved model.</p></li>
<li><p><strong>checkpoint_name</strong> (<em>-</em>) – saved model name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the predicted outcomes on the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Test fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on testing set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.predict_counterfactual_trajectories">
<code class="sig-name descname">predict_counterfactual_trajectories</code><span class="sig-paren">(</span><em class="sig-param">encoder_model</em>, <em class="sig-param">dataset</em>, <em class="sig-param">patient_id</em>, <em class="sig-param">timestep</em>, <em class="sig-param">treatment_options</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.predict_counterfactual_trajectories"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.predict_counterfactual_trajectories" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the counterfactual trajectories for a patient and for the specified future treatment options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder_model</strong> (<em>-</em>) – trained encoder model needed for initializing the decoder</p></li>
<li><p><strong>dataset</strong> (<em>-</em>) – dataset with test patients</p></li>
<li><p><strong>patient_id</strong> (<em>-</em>) – patient id of patient for which the counterfactuals are computed</p></li>
<li><p><strong>timestep</strong> (<em>-</em>) – timestept in the patient trajectory where counterfactuals are predicted</p></li>
<li><p><strong>treatment_options</strong> (<em>-</em>) – treatment options for computing the counterfactual trajectories</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – test fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>history of previous outpus for the patient.
- counterfactual_trajectories: trajectories of counterfactual predictions for the specified future treatments</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>history</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.save_network">
<code class="sig-name descname">save_network</code><span class="sig-paren">(</span><em class="sig-param">tf_session</em>, <em class="sig-param">model_dir</em>, <em class="sig-param">checkpoint_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.save_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.save_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Save trained network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf_session</strong> (<em>-</em>) – TensorFlow session.</p></li>
<li><p><strong>model_dir</strong> (<em>-</em>) – directory where to save the model.</p></li>
<li><p><strong>checkpoint_name</strong> (<em>-</em>) – saved model name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.CRN_Model.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">dataset_train</em>, <em class="sig-param">dataset_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/CRN/CRN_Model.html#CRN_Model.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.CRN_Model.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the CRN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_train</strong> (<em>-</em>) – training dataset.</p></li>
<li><p><strong>param dataset_val</strong> (<em>-</em>) – validation dataset.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="treatments.GANITE_Model">
<em class="property">class </em><code class="sig-prename descclassname">treatments.</code><code class="sig-name descname">GANITE_Model</code><span class="sig-paren">(</span><em class="sig-param">hyperparams</em>, <em class="sig-param">task=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GANITE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyperparams</strong> (<em>-</em>) – dictionary with the hyperparameters specifying the architecture of the GANITE model.</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’</p></li>
<li><p><strong>static_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
<li><p><strong>time_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="treatments.GANITE_Model.data_preprocess">
<code class="sig-name descname">data_preprocess</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold</em>, <em class="sig-param">split</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.data_preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.data_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>split</strong> (<em>-</em>) – ‘train’, ‘valid’ or ‘test’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>stacked dataset dictionary for training GANITE.
-  x: original time-series patient features.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>stacked_dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.discriminator">
<code class="sig-name descname">discriminator</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">t</em>, <em class="sig-param">y</em>, <em class="sig-param">tilde_y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.discriminator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.discriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Counterfactual Discrimnator. Discriminates which outcomes are factual or counterfactual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>-</em>) – imput features</p></li>
<li><p><strong>t</strong> (<em>-</em>) – factual treatment</p></li>
<li><p><strong>y</strong> (<em>-</em>) – factual outcome</p></li>
<li><p><strong>tilde_y</strong> (<em>-</em>) – counterfactual_outcomes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>logits for all potential outcomes indicating whether they are factual or counterfactual.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>D_logit</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">val_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the treatment effects model model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.generator">
<code class="sig-name descname">generator</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">t</em>, <em class="sig-param">y</em>, <em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.generator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Counterfactual Generator. Generates the counterfactual outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>-</em>) – imput features</p></li>
<li><p><strong>t</strong> (<em>-</em>) – factual treatment</p></li>
<li><p><strong>y</strong> (<em>-</em>) – factual outcome</p></li>
<li><p><strong>z</strong> (<em>-</em>) – noise</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generated counterfactual outcomes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>G_logit</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.inference">
<code class="sig-name descname">inference</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.inference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference network. Predicts all potential outcomes given input features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>-</em>) – input features</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted potential outcomes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>I_logit</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.init_model">
<code class="sig-name descname">init_model</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.init_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.init_model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>-</em>) – initialize the placeholder variables in the TensorFlow graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the predicted outcomes on the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on testing set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.process_sequence_predictions">
<code class="sig-name descname">process_sequence_predictions</code><span class="sig-paren">(</span><em class="sig-param">stacked_predictions</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.process_sequence_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.process_sequence_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Process stacked predictions to create time-series predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stacked_predictions</strong> (<em>-</em>) – stacked predicted outcomes for test patients.</p></li>
<li><p><strong>x</strong> (<em>-</em>) – original time-series patient features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>time series predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.sample_X">
<code class="sig-name descname">sample_X</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.sample_X"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.sample_X" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a batch of input features.</p>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.sample_Z">
<code class="sig-name descname">sample_Z</code><span class="sig-paren">(</span><em class="sig-param">m</em>, <em class="sig-param">n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.sample_Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.sample_Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Random sample noize of size [m, n]</p>
</dd></dl>

<dl class="method">
<dt id="treatments.GANITE_Model.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">Train_X</em>, <em class="sig-param">Train_T</em>, <em class="sig-param">Train_Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/GANITE/GANITE_Model.html#GANITE_Model.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.GANITE_Model.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train GANITE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Train_X</strong> (<em>-</em>) – training patient features.</p></li>
<li><p><strong>Train_T</strong> (<em>-</em>) – training factual treatments.</p></li>
<li><p><strong>Train_Y</strong> (<em>-</em>) – training factual outcomes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="treatments.RMSN_Model">
<em class="property">class </em><code class="sig-prename descclassname">treatments.</code><code class="sig-name descname">RMSN_Model</code><span class="sig-paren">(</span><em class="sig-param">model_dir</em>, <em class="sig-param">model_name</em>, <em class="sig-param">task=None</em>, <em class="sig-param">static_mode=None</em>, <em class="sig-param">time_mode=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/RMSN/RMSN_Model.html#RMSN_Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.RMSN_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the Counterfactual Recurrent Network (CRN).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dir</strong> (<em>-</em>) – directory where to save the model</p></li>
<li><p><strong>model_name</strong> (<em>-</em>) – model name</p></li>
<li><p><strong>task</strong> (<em>-</em>) – ‘classification’ or ‘regression’</p></li>
<li><p><strong>static_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
<li><p><strong>time_mode</strong> (<em>-</em>) – ‘concatenate’ or None</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="treatments.RMSN_Model.data_preprocess">
<code class="sig-name descname">data_preprocess</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold</em>, <em class="sig-param">split</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/RMSN/RMSN_Model.html#RMSN_Model.data_preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.RMSN_Model.data_preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>split</strong> (<em>-</em>) – ‘train’, ‘valid’ or ‘test’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset dictionary for training the RMSN.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dataset</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.RMSN_Model.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">train_split='train'</em>, <em class="sig-param">val_split='val'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/RMSN/RMSN_Model.html#RMSN_Model.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.RMSN_Model.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the treatment effects model model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>train_split</strong> (<em>-</em>) – training set splitting parameter</p></li>
<li><p><strong>valid_split</strong> (<em>-</em>) – validation set splitting parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="treatments.RMSN_Model.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">fold=0</em>, <em class="sig-param">test_split='test'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treatments/RMSN/RMSN_Model.html#RMSN_Model.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#treatments.RMSN_Model.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the predicted outcomes on the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>-</em>) – temporal, static, label, time, treatment information</p></li>
<li><p><strong>fold</strong> (<em>-</em>) – Cross validation fold</p></li>
<li><p><strong>test_split</strong> (<em>-</em>) – testing set splitting parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions on testing set</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>test_y_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="utils.concate_xs">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">concate_xs</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#concate_xs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.concate_xs" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate static features to temporal feature for every time point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – temporal features</p></li>
<li><p><strong>s</strong> – static features</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>concatenate temporal and static features</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>concate_x</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.concate_xt">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">concate_xt</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">t</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#concate_xt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.concate_xt" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate time feature to temporal feature for every time point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – temporal features</p></li>
<li><p><strong>t</strong> – time feature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>concatenate temporal and time features</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>concate_x</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.list_diff">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">list_diff</code><span class="sig-paren">(</span><em class="sig-param">list1</em>, <em class="sig-param">list2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#list_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.list_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute list differences in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list1</strong> (<em>-</em>) – first list</p></li>
<li><p><strong>list2</strong> (<em>-</em>) – second list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list difference</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>out</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.padding">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">padding</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">max_seq_len</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence data padding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>-</em>) – temporal features</p></li>
<li><p><strong>max_seq_len</strong> (<em>-</em>) – maximum sequence_length</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>padded temporal features</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>x_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.index_reset">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">index_reset</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#index_reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.index_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset index in the pandas dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – original pandas dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data with new indice</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>x</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.pd_list_to_np_array">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">pd_list_to_np_array</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">drop_columns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#pd_list_to_np_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.pd_list_to_np_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert list of pandas dataframes to 3d numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>-</em>) – list of pandas dataframe</p></li>
<li><p><strong>drop_column</strong> (<em>-</em>) – column names to drop before converting to numpy array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3d numpy array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>x_hat</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.normalization">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">normalization</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">subtract_val</em>, <em class="sig-param">division_val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#normalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>-</em>) – input data</p></li>
<li><p><strong>normalizer_type</strong> (<em>-</em>) – ‘minmax’ or ‘standard’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized data
- norm_parameters: parameters for renomalization</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>df</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.renormalization">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">renormalization</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">norm_parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/data_utils.html#renormalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.renormalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Renormalizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>-</em>) – input data</p></li>
<li><p><strong>norm_parameters</strong> (<em>-</em>) – parameters for renomalization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>renormalized data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>df</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.binary_cross_entropy_loss">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">binary_cross_entropy_loss</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#binary_cross_entropy_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.binary_cross_entropy_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>User defined cross entropy loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>-</em>) – true labels</p></li>
<li><p><strong>y_pred</strong> (<em>-</em>) – predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>computed loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>loss</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.mse_loss">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">mse_loss</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#mse_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.mse_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>User defined mean squared loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>-</em>) – true labels</p></li>
<li><p><strong>y_pred</strong> (<em>-</em>) – predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>computed loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>loss</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.select_loss">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">select_loss</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#select_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.select_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>User defined selection loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>-</em>) – true labels</p></li>
<li><p><strong>y_pred</strong> (<em>-</em>) – predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>computed selection loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>loss</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.rmse_loss">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">rmse_loss</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#rmse_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.rmse_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>User defined root mean squared loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>-</em>) – true labels</p></li>
<li><p><strong>y_pred</strong> (<em>-</em>) – predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>computed loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>loss</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.rnn_layer">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">rnn_layer</code><span class="sig-paren">(</span><em class="sig-param">input_layer</em>, <em class="sig-param">model_name</em>, <em class="sig-param">h_dim</em>, <em class="sig-param">return_seq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#rnn_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.rnn_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one rnn layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_layer</strong> (<em>-</em>) – </p></li>
<li><p><strong>model_name</strong> (<em>-</em>) – rnn, lstm, or gru</p></li>
<li><p><strong>h_dim</strong> (<em>-</em>) – hidden state dimensions</p></li>
<li><p><strong>return_seq</strong> (<em>-</em>) – True or False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>output_layer</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.rnn_sequential">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">rnn_sequential</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">model_name</em>, <em class="sig-param">h_dim</em>, <em class="sig-param">return_seq</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#rnn_sequential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.rnn_sequential" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one rnn layer in sequential model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>-</em>) – sequential rnn model</p></li>
<li><p><strong>model_name</strong> (<em>-</em>) – rnn, lstm, or gru</p></li>
<li><p><strong>h_dim</strong> (<em>-</em>) – hidden state dimensions</p></li>
<li><p><strong>return_seq</strong> (<em>-</em>) – True or False</p></li>
<li><p><strong>name</strong> (<em>-</em>) – layer name</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sequential rnn model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="utils.compose">
<code class="sig-prename descclassname">utils.</code><code class="sig-name descname">compose</code><span class="sig-paren">(</span><em class="sig-param">*functions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#compose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.compose" title="Permalink to this definition">¶</a></dt>
<dd><p>Compose multiple functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>functions</strong> (<em>-</em>) – functions for composing</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>composed function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>inner</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="utils.PipelineComposer">
<em class="property">class </em><code class="sig-prename descclassname">utils.</code><code class="sig-name descname">PipelineComposer</code><span class="sig-paren">(</span><em class="sig-param">*stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#PipelineComposer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.PipelineComposer" title="Permalink to this definition">¶</a></dt>
<dd><p>Composing a pipeline from stages.</p>
<dl class="attribute">
<dt>
<code class="sig-name descname">- *stage</code></dt>
<dd><p>individual stages in the pipeline</p>
</dd></dl>

<dl class="method">
<dt id="utils.PipelineComposer.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#PipelineComposer.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.PipelineComposer.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the whole pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – Input data for fitting</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="utils.PipelineComposer.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#PipelineComposer.fit_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.PipelineComposer.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the whole pipeline and apply the transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – Input data for fit and transform</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="utils.PipelineComposer.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/model_utils.html#PipelineComposer.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#utils.PipelineComposer.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the whole pipeline to transform the data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>-</em>) – Input data for transform</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="intro/tutorial.html" class="btn btn-neutral float-left" title="Clairvoyance Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, ML-AIM

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>